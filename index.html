<script type="module">
  // Load the Observable Runtime.
  import { Runtime } from "https://unpkg.com/@observablehq/notebook-runtime?module";
  
  const renderNotebook = notebook => {
    console.log('notebook', notebook);
  
    // Load the notebook, and render any cells which start with "rendered_".
    Runtime.load(notebook, (cell) => {
      if (cell.name && cell.name.startsWith('rendered_')) {
        return {
          fulfilled: (value) => {
            if (value instanceof HTMLElement) {
              document.body.appendChild(value);
            }
          }
        };
      }
    });
  });
  
  const getUrlParams = () => {
    var params = {};
    window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, (m, key, value) => params[key] = value);
    return params;
  }
  
  const urlParams = getUrlParams();
  const getUrlParam = (name, defaultValue) => urlParams[name] || defaultValue;

  // Import the notebook.
  const url = `https://api.observablehq.com/${getUrlParam('name', '@trebor')}/${getUrlParam('notebook', 'portfolio')}.js`;
  console.log('url', url);
  var notebook = null;
  
  import(url)
    .then((module) => {
      console.log('module', module);
      renderNotebook(module);
    });

</script>
